!/bin/bash

for GROUP  in $(ls $PATH/TO/GROUPS); do                            #groups is our 3 groups young/old/dis
	cd $PATH/TO/GROUPS/GROUP
	for SAMPLE in $(ls $PATH/TO/GROUPS/GROUP); do		   #sample is every sample of our groups
		echo "******************"
		echo "****** $SAMPLE ******" 			   
		echo "******************"
		for gz in $(ls $PATH/TO/GROUPS/GROUP/SAMPLE);do    #every file for my samples had .gz extension
		x=$(ls $PATH/TO/GROUPS/GROUP/SAMPLE | grep -E .*.fastq.gz$ | awk -F \. '{print $1}')    #we put in X the name of the SAMPLE so during the analysis we can use the name and change the extension for every file that we'll create connected to that sample
		cd $PATH/TO/GROUPS/GROUP/SAMPLE
		gunzip $x'_T_bash.fq.gz'
		fastqc $x'.fastq.gz'
		java -jar 'PATH/TO/Trimmomatic-0.39/trimmomatic-0.39.jar'  SE -threads n -phred33 $x.'fastq.gz' $x'_T_bash.fq.gz' ILLUMINACLIP:'PATH/TO/ADAPTERS':2:30:10 SLIDINGWINDOW:5:20 MINLEN:15  #trimming process
		fastqc $x'_T_bash.fq.gz'
		$PATH/TO/STAR  --runThreadN $n --genomeDir $PATH/TO/REFERENCE/GENOME  --readFilesIn $x'_T_bash.fq' --outSAMtype BAM SortedByCoordinate --quantMode GeneCounts --outFileNamePrefix $PATH/TO/OUTPOUT/FILES/AND/PREFIX                 #alignment process 
		htseq-count -f bam -s reverse 'PATH/TO/GROUPS/GROUP/SAMPLE/STARAligned.sortedByCoord.out.bam' '$PATH/TO/REFERENCE/GENOME' > $PATH/TO/OUTPUT/FILE/$x_htseqcount.txt              #we'll have a file with name of sample analysed and its genetic counts 
	done
done



